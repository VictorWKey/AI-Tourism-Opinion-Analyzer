"""
Analizador Temporal - An√°lisis de aspectos temporales
"""

import pandas as pd
from datetime import datetime


class AnalizadorTemporal:
    """Analiza aspectos temporales del dataset."""
    
    def __init__(self, df):
        self.df = df
    
    def analizar_temporal(self):
        """
        Analiza aspectos temporales del dataset.
        """
        if 'FechaOpinion' in self.df.columns:
            print("=== AN√ÅLISIS TEMPORAL DE OPINIONES ===")
            
            # Mostrar algunas fechas de ejemplo
            print("Ejemplos de fechas en el dataset:")
            print(self.df['FechaOpinion'].head(10).tolist())
            
            # Contar valores √∫nicos en fechas
            print(f"\nFechas √∫nicas de opini√≥n: {self.df['FechaOpinion'].nunique()}")
            
            # Mostrar las fechas m√°s comunes
            print("\nTop 10 fechas con m√°s opiniones:")
            print(self.df['FechaOpinion'].value_counts().head(10))
    
    def analisis_temporal_final(self):
        """
        An√°lisis temporal para dataset final limpio.
        """
        if 'FechaOpinion' in self.df.columns:
            print(f"\nüìÖ AN√ÅLISIS TEMPORAL FINAL:")
            rango_fechas = self.df['FechaOpinion'].dropna()
            if len(rango_fechas) > 0:
                fecha_min = rango_fechas.min()
                fecha_max = rango_fechas.max()
                print(f"   ‚Ä¢ Rango de fechas: {fecha_min.strftime('%d/%m/%Y')} - {fecha_max.strftime('%d/%m/%Y')}")
                print(f"   ‚Ä¢ Per√≠odo cubierto: {(fecha_max - fecha_min).days} d√≠as")
                
                # An√°lisis por a√±o
                print(f"   ‚Ä¢ Distribuci√≥n por a√±o:")
                dist_a√±os = self.df['FechaOpinion'].dt.year.value_counts().sort_index()
                for a√±o, count in dist_a√±os.items():
                    porcentaje = (count / len(self.df)) * 100
                    print(f"     {a√±o}: {count:,} opiniones ({porcentaje:.1f}%)")
